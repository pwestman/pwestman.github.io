<ARTICLE ID="Article_1">
 <HEADER ID="Header_Article_1">
  <H2>Build Log: Bee Tracker</H2>
 </HEADER>
	
	<SECTION ID="Section_18">
	 <H3>Introduction and System Diagram</H3>
		<p><b>Introduction</b></p>
		<p>The purpose of the Bee Tracker project is to keep an accurate count of the number of bees in the hive at any time. This is done by IR Optical Interrupter modules that are mounted on either side of an acrylic gate at various entrance holes that is mounted in front of the entrance to the bee hive. This way, any time a bee enters or leaves the hive, it will be recorded. This is done by mounting the sensors on either side of the gate and checking if the first sensor detects an interruption followed by the second. This would indicate an entry and a counter would be incremented. If the sensors detected an interruption in the opposite order, this would indicate an exit and decrement the counter.</p>
		<p><b>System Diagram</b></p>
		<p><img src="../Images/system-diagram.png" alt="System Diagram" style="width:700px;height:400px;"></p>
		<p><i>Figure 1: The system diagram showing the interaction of the inputs, processes, and outputs that will be integrated over the next semester.</i></p>
	</SECTION>
	
	<SECTION ID="Section_17">
	 <H3>Bill of Materials/Budget</H3>
		<table>
		  <tr>
		    <th>Item</th>
		    <th>Quantity</th>
		    <th>Cost (after tax)</th>
		  </tr>
		  <tr>
		    <td>Infrared Optical Interrupter Module (GP1A57HRJ00F)</td>
		    <td>10</td>
		    <td align="right">$80.80 </td>
		  </tr>
		  <tr>
		    <td>Raspberry Pi Model B Complete Starter Kit – 32 GB Edition</td>
		    <td align="right">1</td>
		    <td align="right">$112.99</td>
		  </tr>
		  <tr>
		    <td>Full Size Breadboard</td>
		    <td>1</td>
		    <td align="right">$8.81</td>
		  </tr>
		  <tr>
		    <td>Full Size Breadboard</td>
		    <td>1</td>
		    <td align="right">$8.81</td>
		  </tr>
		  <tr>
		    <td>LEDs</td>
		    <td>1</td>
		    <td align="right">$0.28</td>
		  </tr>
		  <tr>
		    <td>Electrical Tape</td>
		    <td>1 roll</td>
		    <td align="right">$1.70</td>
		  </tr>
		  <tr>
		    <td>50 Ohm Resistor</td>
		    <td>1</td>
		    <td align="right">$0.28</td>
		  </tr>
		  <tr>
		    <td>6” M-F Jumper Cables</td>
		    <td>40</td>
		    <td align="right">$13.47</td>
		  </tr>
		  <tr>
		    <td>12” M-F Jumper Cables</td>
		    <td>30</td>
		    <td align="right">$15.19</td>
		  </tr>
		  <tr>
		    <td>Acrylic Sheet (0.08-in x 8-in x 10-in)</td>
		    <td>1</td>
		    <td align="right">$3.79</td>
		  </tr>
		  <tr>
		    <td></td>
		    <td><b>Total:</b></td>
		    <td align="right">$237.31</td>
		  </tr>
		</table>
		<p><i>Table 1: The expected cost of building the project.</i></p>
		<p>Click on the link to download the final detailed <a href="https://pwestman.github.io/Deliverables/Budget Final.xlsx">Budget.</a></p>
		
	</SECTION>
	
	<SECTION ID="Section_16">
	 <H3>Time Commitment</H3>
		<p>This is a general guideline of how long it should take to go from ordering the components to having a finished, working product. The idea is that anyone should be able to follow these build instructions and be able to finish the project in the indicated time as no research has to be done, rather it has all been done by me through this project.</p>
		<table>
		  <tr>
		    <th>To Do</th>
		    <th>Time Required</th>
		  </tr>
		  <tr>
		    <td>Ordering of parts/components</td>
		    <td>1 business day (All components can be ordered through Creatron Inc. online, which offers 1 business day shipping in Toronto)</td>
		  </tr>
		  <tr>
		    <td>Cutting the acrylic hive entrance</td>
		    <td align="right">10 minutes</td>
		  </tr>
		  <tr>
		    <td>Attaching the IR Optical Interrupter Sensors to the acrylic hive entrance</td>
		    <td align="right">30 minutes</td>
		  </tr>
		  <tr>
		    <td>Wiring the sensors to the breadboard and to the Raspberry Pi</td>
		    <td align="right">1 hour</td>
		  </tr>
		  <tr>
		    <td>Setting up the Raspberry Pi and Importing the beeCounter.py code</td>
		    <td align="right">15 minutes</td>
		  </tr>
		  <tr>
		    <td>Running the code with the hardware connected</td>
		    <td align="right">5 minutes</td>
		  </tr>
		  <tr>
		    <td>Unit testing if you do not get the expected output</td>
		    <td align="right">Unknown</td>
		  </tr>
	          <tr>
		    <td><b>Total Time Commitment:</b></td>
		    <td align="right">~ 2 Days</td>
		  </tr>
		</table>
		<p><i>Table 2: Amount of time expected to assemble and test the project.</i></p>
		<p>Here is a link to the original <a href="https://pwestman.github.io/Deliverables/GanttChart.mpp">schedule</a> to complete the project.</p>
		
		
	</SECTION>
	
	<SECTION ID="Section_15">
	 <H3>Mechanical Assembly</H3>
		<p><u>Build Steps:</u></p>
		<ol>
		  <li>Use the template at pwestman.github.io under Week 14 to laser cut the gate from the sheet of acrylic.</li>
			<p><img src="../Images/hive-front.png" alt="Front Hive" style="width:700px;height:300px;"></p>
			<p><i>Figure 2: Front of the Hive. Click to download the <a href="https://pwestman.github.io/Deliverables/front-hive.pdf">template.</a></i></p>
			<p><img src="../Images/hive-side.png" alt="Side Hive" style="width:700px;height:300px;"></p>
			<p><i>Figure 3: Sides of the hive to hold up the front piece for testing. Click to download the <a href="https://pwestman.github.io/Deliverables/side-hive.pdf">template.</a></i></p>
		  <li>Attach the IR Optical Interrupter Modules on either side of each of the 5 holes on your piece of cut acrylic using the electrical tape (These can also be glued, however, I used electrical tape for a less permanent solution in order to use the sensors again once I collaborate with my other group members on the final project).</li>
			<p><pre>			<img src="../Images/IR-Sensor.jpg" alt="IR Optical Interrupter Module" style="width:200px;height:200px;"></pre></p>
			<p><i>Figure 4: The GP1A57HRJ00F IR Optical Interrupter Sensor</i></p>
		  <li>Run a jumper wire from pin number 2 (5V) of the Raspberry Pi to the positive connected bus on one side of the breadboard.</li>
		  <li>Run another jumper wire from pin 3 (Ground) to the negative connected bus on the other side of the breadboard.</li>
			<p>	<pre><img src="../Images/breadboard.jpg" alt="breadboard" style="width:500px;height:400px;"></pre></p>
			<p><i>Figure 5: A breadboard showing the hole connections (Source: http://dm.risd.edu/pbadger/PhysComp/index.php?n=Devices.Breadboard)</i></p>
		  <li>Connect the power pin on each of the IR sensors to the 5V connected bus on the breadboard.</li>
		  <li>Connect the ground pin on each of the IR sensors to the Ground connected bus on the breadboard.</li>
		  <li>Now for each IR sensor, connect the pin labelled “Signal” to a separate group of 5 connected pin hole. Ensure that each signal pin is in its own group of 5 horizontally connected pin hole.</li>
		  <li>Follow the chart below to connect the GPIO pins on the Raspberry Pi header to the appropriate group of 5 signal bus. </li>
			<p>When looking at the acrylic entrance from the front, from left to right:</p>
			<table>
			  <tr>
			    <th>Sensor</th>
			    <th>Raspberry Pi GPIO Pin</th>
			  </tr>
			  <tr>
			    <td>1st Sensor - Front</td>
			    <td>16</td>
			  </tr>
			  <tr>
			    <td>1st Sensor - Back</td>
			    <td align="right">18</td>
			  </tr>
			  <tr>
			    <td>2nd Sensor – Front</td>
			    <td align="right">11</td>
			  </tr>
			  <tr>
			    <td>2nd Sensor - Back</td>
			    <td align="right">13</td>
			  </tr>
			  <tr>
			    <td>3rd Sensor – Front</td>
			    <td align="right">12</td>
			  </tr>
			  <tr>
			    <td>3rd Sensor – Back</td>
			    <td align="right">15</td>
			  </tr>
			  <tr>
			    <td>4th Sensor – Front</td>
			    <td align="right">29</td>
			  </tr>
			  <tr>
			    <td>4th Sensor – Back</td>
			    <td align="right">31</td>
			  </tr>
			  <tr>
			    <td>5th Sensor – Front</td>
			    <td align="right">33</td>
			  </tr>
			  <tr>
			    <td>5th Sensor - Back</td>
			    <td align="right">35</td>
			  </tr>
			</table>
			<p><i>Table 3: Mapping the pins from the sensors to the Raspberry Pi.</i></p>
			<p>Ensure that each signal pin from the sensor is plugged in to the same group of 5 connected bus as the corresponding pin on the Raspberry Pi GPIO pins.</p>
		  <li>Connect the LED to an arbitrary pin hole in the breadboard. Ensure the LED pins are not in the same group of 5 connected bus. Connect a jumper wire from pin 22 on the Raspberry Pi GPIO pins to the same group of 5 connected bus as the long end of the LED.</li>
		  <li>Connect a 50 Ohm resistor to the same group of 5 connected bus as the short end of the LED.</li>
		  <li>Connect a jumper wire from the same group of 5 connected bus as the resistor to the ground connected bus on the breadboard.</li>
		</ol> 
		<p><b>Complete Build Video</b></p>
		<p><iframe src="https://player.vimeo.com/video/194432694" width="640" height="360" frameborder="0" webkitallowfullscreen mozallowfullscreen allowfullscreen></iframe> <p><a href="https://vimeo.com/194432694">Build Video - Bee Tracker</a> from <a href="https://vimeo.com/user58499739">Paul Westman</a> on <a href="https://vimeo.com">Vimeo</a>.</p>
				
	</SECTION>
	
	<SECTION ID="Section_14">
	 <H3>PCB/Soldering</H3>
		<p>This project did not use a PCB, however, a PCB could be used for the LED indicator if you wish to do so.</p>
		
	</SECTION>
	
	<SECTION ID="Section_13">
	 <H3>Power Up</H3>
		<p>Now that your mechanical assembly is complete, turn on the Raspberry Pi. Create a new file called <a href="https://pwestman.github.io/Deliverables/beeCounter.py">beeCounter.py</a> and copy and paste the code from the link to the file. In the command line type ./sudo idle and run the Python code. The program should begin to run, but you will not see any output until you pass an object through one of the gates. This will increment the counter on the terminal as well as light up the LED on the breadboard.</p>
		
	</SECTION>
	
	<SECTION ID="Section_12">
	 <H3>Unit Testing</H3>
		<p>Since this project provides complete build instructions, unit testing should not be required because I have done the unit testing to get the project to work. However, if you encounter any problems in the mechanical assembly, unit testing may be helpful. Here is some of the unit testing I did on the project:</p>
		<p><u>Testing one sensor:</u></p>
		<code><pre>
			GPIO.setmode(GPIO.BOARD)
			GPIO.setup(22,GPIO.OUT)
			GPIO.setup(16,GPIO.IN)

			count=0
			gate1=1

			try:
			    while True:
				if GPIO.input(16)==0:
					if gate1==1:
						count+=1
						GPIO.output(22,True)
						time.sleep(0.2)
						GPIO.output(22,False)
						print count
						gate1=0
		</pre></code>
		<p>You can replace the GPIO.setup and GPIO.input functions with any pin you wish to test. This will test if that one particular pin is working.</p>
		<p><u>Testing both sensors at one gate:</u></p>
		<p>To test the pair of sensors on either side of the gate, run the following code:</p>
		<code><pre>
			import RPi.GPIO as GPIO
			import time

			GPIO.setmode(GPIO.BOARD)
			GPIO.setup(22,GPIO.OUT)
			GPIO.setup(16,GPIO.IN)

			count=0
			gate1=1

			try:
			    while True:
				if GPIO.input(16)==0:
				    if GPIO.input(18)==0:
					if gate1==1:
					    count+=1
					    GPIO.output(22,True)
					    time.sleep(0.2)
					    GPIO.output(22,False)
					    print count
					    gate1=0
				elif GPIO.input(18)==0:
				    if GPIO.input(16)==0:
					if gate1==1:
					    count-=1
					    GPIO.output(22,True)
					    time.sleep(0.1)
					    GPIO.output(22,False)
					    time.sleep(0.1)
					    GPIO.output(22,True)
					    time.sleep(0.1)
					    GPIO.output(22,False)
					    print count
					    gate1=0
				else:
				    gate1=1
		</pre></code>
		<p>You can replace the GPIO.setup and GPIO.input functions with any two pins that are on opposite sides of the same gate that you wish to test. This will test if both particular pins are working at one gate for an object entering or exiting.</p>
		
	</SECTION>
	
	<SECTION ID="Section_11">
	 <H3>Production Testing</H3>
		<p>Now you are ready for production testing. Run the beeCounter.py program and test objects entering and exiting through the gates and check whether the counter increments and decrements accordingly. The LED should blink once for an object entering and blink twice for an object exiting. If you encounter problems, check your wiring and go back and do unit testing on the troublesome gates, by running the unit testing code with the appropriate pins on the Raspberry Pi.</p>
		
	</SECTION>
	
	<SECTION ID="Section_10">
	 <H3>Reproducibility Based on Instructions</H3>
		<p>By following these build instructions, anyone should be able to have a working prototype of the Bee Counter project. The only setbacks one should have are when ordering the parts because of availability and delivery times based on where someone might live. Other than that, by following these instructions anyone should be able to have the same working prototype at the end of these instructions as the one that I have now. </p>
	</SECTION>

</ARTICLE>
